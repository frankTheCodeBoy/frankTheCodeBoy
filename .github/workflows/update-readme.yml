name: Update README with Certification Dates

on:
  workflow_dispatch:
  schedule:
    - cron: '0 0 * * 0' # Runs every Sunday at midnight

jobs:
  update-readme:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Get current date
        id: date
        run: echo "date=$(date +'%B %Y')" >> $GITHUB_OUTPUT

      - name: Update certification and footer dates in README
        run: |
          sed -i 's|_Last updated: .*_ 路 <!-- cert-date -->|_Last updated: ${{ steps.date.outputs.date }}_ 路 <!-- cert-date -->|' README.md
          sed -i 's|<sub><em>Last updated: .* 路 All assets and badges are locally sourced or verified</em></sub>  <!-- footer-date -->|<sub><em>Last updated: ${{ steps.date.outputs.date }} 路 All assets and badges are locally sourced or verified</em></sub>  <!-- footer-date -->|' README.md

      - name: Commit changes
        run: |
          git config --global user.name 'github-actions'
          git config --global user.email 'github-actions@github.com'
          git add README.md
          git commit -m "Auto-update certification and footer dates"
          git push
